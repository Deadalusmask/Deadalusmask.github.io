<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" type="image/png" href="/favicon.png"/><meta name="theme-color" content="#000000"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/><meta name="image" content="/favicon.png"/><title>像素游戏的光照效果 -Arthas.me</title><meta property="og:url" content="https://arthas.me/posts/Lighting-in-pixel-game"/><meta property="og:type" content="article"/><meta property="og:title" content="像素游戏的光照效果"/><meta property="og:image" content="/favicon.png"/><meta name="twitter:title" content="像素游戏的光照效果"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="/favicon.png"/><meta name="twitter:creator" content="@deadalusmask"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/0a15d971913fef300597.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0a15d971913fef300597.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-67279fe62e81e3dbb4fe.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.2113c6061a2f456066a1.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.f771efd637e54964f7dc.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-7787517220261cbe4aba.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-44fb0cf09ad137619ef8.js" as="script"/></head><body><div id="__next"><div class="page"><h3><a href="/">Arthas.me</a> / <a href="/posts">Posts</a> /</h3><h1>像素游戏的光照效果</h1><span>2018.3.6</span><div class="md-content"><p>通过 Pixpil 的微博了解到，Eastward 的光照效果中用到了法线贴图。</p>
<p><img src="/img/ew.gif" alt="Eastward中的光照"></p>
<p>遂搜索，找到了一篇 2D 游戏照明的介绍：</p>
<blockquote>
<p><a href="http://www.wholehog-games.com/devblog/2013/06/07/lighting-in-a-2d-game/">Lighting a 2D Game</a></p>
</blockquote>
<p>其作者是<a href="http://store.steampowered.com/app/264060/Full_Bore/">《Full_Bore》</a>的开发者，根据他的介绍，Full Bore 用基本的漫射贴图(Diffuse)、自发光的强度贴图(Self-Illumination)和法线贴图(Normal)来实现最终的光照效果。</p>
<p>虽然之前跟着教程做铁砧时生成过法线贴图，不过并没有明白其原理。法线贴图(Normal Map)通过改变物体表面法线的方向，来改变光照的反射效果,使其看起来并不是一个平面而具有更多细节。法线方向用 XYZ 三个方向的大小描述，而图片刚好有 RGB 三个颜色通道。法线贴图的红色通道描述水平方向，绿色通道描述垂直方向，蓝色通道描述垂直于表面的方向。法线贴图中大部分都是淡蓝色是因为平整的地方的法线方向为垂直于表面朝上，所以红绿通道都是中间值 127，表示 0 向量。蓝色通道为 255，表示垂直于表面朝上的单位向量。而(127,127,255)就是法线贴图中常见的那种蓝色。</p>
<p>这是尝试像素 3D 光照的图片：</p>
<p><img src="/img/lighting-test.png" alt="原图"></p>
<p>先根据原图画出凹凸图(Bump Map)：</p>
<p><img src="/img/lighting-test-grey.png" alt="Bump map"></p>
<p>然后在 PS 中生成法线图(PS 中生成的法线图的红色通道数值表示的法线方向似乎与 Unity 和 Blender 中是相反的，所以在生成法线图前需要先把图片水平翻转，生成后再翻转回来保存，并且生成后可能需要进行一些调整。)：</p>
<p><img src="/img/lighting-test-nrm.png" alt="Normal map"></p>
<p>这是在 Blender 中贴上法线贴图后的效果：</p>
<p><img src="/img/res1.png" alt="res1"></p>
<p><img src="/img/res2.png" alt="res2"></p>
<p>在自发光的物体方面，虽然能通过黑白的自发光强度图在 blender 中烘焙出 emit 并应用于 Unity，但发出的光不能明显的影响这张图上发光物体周围的像素，效果并不好，还需要继续研究。</p>
<p>接下来想学自己写 Shader，看看到底能实现什么。</p></div><hr class="hr"/><div style="display:flex;justify-content:space-between"><a style="margin-right:24px" href="/posts/winter-vacation-daily">寒假日常</a><a href="/posts/Retro-Pixel-Button">Retro Pixel Button</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"像素游戏的光照效果","date":1520273614000,"slug":"Lighting-in-pixel-game","content":"\u003cp\u003e通过 Pixpil 的微博了解到，Eastward 的光照效果中用到了法线贴图。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/ew.gif\" alt=\"Eastward中的光照\"\u003e\u003c/p\u003e\n\u003cp\u003e遂搜索，找到了一篇 2D 游戏照明的介绍：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://www.wholehog-games.com/devblog/2013/06/07/lighting-in-a-2d-game/\"\u003eLighting a 2D Game\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e其作者是\u003ca href=\"http://store.steampowered.com/app/264060/Full_Bore/\"\u003e《Full_Bore》\u003c/a\u003e的开发者，根据他的介绍，Full Bore 用基本的漫射贴图(Diffuse)、自发光的强度贴图(Self-Illumination)和法线贴图(Normal)来实现最终的光照效果。\u003c/p\u003e\n\u003cp\u003e虽然之前跟着教程做铁砧时生成过法线贴图，不过并没有明白其原理。法线贴图(Normal Map)通过改变物体表面法线的方向，来改变光照的反射效果,使其看起来并不是一个平面而具有更多细节。法线方向用 XYZ 三个方向的大小描述，而图片刚好有 RGB 三个颜色通道。法线贴图的红色通道描述水平方向，绿色通道描述垂直方向，蓝色通道描述垂直于表面的方向。法线贴图中大部分都是淡蓝色是因为平整的地方的法线方向为垂直于表面朝上，所以红绿通道都是中间值 127，表示 0 向量。蓝色通道为 255，表示垂直于表面朝上的单位向量。而(127,127,255)就是法线贴图中常见的那种蓝色。\u003c/p\u003e\n\u003cp\u003e这是尝试像素 3D 光照的图片：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/lighting-test.png\" alt=\"原图\"\u003e\u003c/p\u003e\n\u003cp\u003e先根据原图画出凹凸图(Bump Map)：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/lighting-test-grey.png\" alt=\"Bump map\"\u003e\u003c/p\u003e\n\u003cp\u003e然后在 PS 中生成法线图(PS 中生成的法线图的红色通道数值表示的法线方向似乎与 Unity 和 Blender 中是相反的，所以在生成法线图前需要先把图片水平翻转，生成后再翻转回来保存，并且生成后可能需要进行一些调整。)：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/lighting-test-nrm.png\" alt=\"Normal map\"\u003e\u003c/p\u003e\n\u003cp\u003e这是在 Blender 中贴上法线贴图后的效果：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/res1.png\" alt=\"res1\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/res2.png\" alt=\"res2\"\u003e\u003c/p\u003e\n\u003cp\u003e在自发光的物体方面，虽然能通过黑白的自发光强度图在 blender 中烘焙出 emit 并应用于 Unity，但发出的光不能明显的影响这张图上发光物体周围的像素，效果并不好，还需要继续研究。\u003c/p\u003e\n\u003cp\u003e接下来想学自己写 Shader，看看到底能实现什么。\u003c/p\u003e"},"prev":{"slug":"winter-vacation-daily","title":"寒假日常","date":1519837064000},"next":{"slug":"Retro-Pixel-Button","title":"Retro Pixel Button","date":1520544631000}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"Lighting-in-pixel-game"},"buildId":"1EFwxkPp7d779ZeTLfDNk","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-a98cee78eb8282e29fb6.js"></script><script src="/_next/static/chunks/main-67279fe62e81e3dbb4fe.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.2113c6061a2f456066a1.js" async=""></script><script src="/_next/static/chunks/commons.f771efd637e54964f7dc.js" async=""></script><script src="/_next/static/chunks/pages/_app-7787517220261cbe4aba.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-44fb0cf09ad137619ef8.js" async=""></script><script src="/_next/static/1EFwxkPp7d779ZeTLfDNk/_buildManifest.js" async=""></script><script src="/_next/static/1EFwxkPp7d779ZeTLfDNk/_ssgManifest.js" async=""></script></body></html>